<HTML>
	<HEAD>
		<meta charset='utf-8'>
		<TITLE>This macro is used to download or download files using the Storage APIs.</TITLE>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
		<link rel='stylesheet' type='text/css' href="../../macros.css">
	</HEAD>

			<body style="margin: 0px">
			<table cellpadding=0 cellspacing=0 class="macros_desc_main_table">
			<tr><td class="macros_tit">sc_api_download(profile, settings, file, destination)<br></td></tr>
			<tr><td style="border: none;">
				<table class="macros_desc_table">
					<tr>
						<td style="border: none;">
							<p>This macro is used to download the files stored in the Storage services available in Scriptcase, they are: Google Drive, DropBox and Amazon S3.</p>
<p>First of all, it is necessary to create the keys to use these APIs, either for use with the macro or through the tool interface.</p>
<p>See below for how to obtain the credentials for each of them.</p>
<ul>
<li><a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-google-drive-api-on-the-google-console" target="_blank" rel="noopener">Click here to learn how to get Google Drive credentials</a></li>
<li><a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-dropbox-api" target="_blank" rel="noopener">Click here to learn how to get DropBox credentials</a></li>
<li><a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-amazon-s3-api" target="_blank" rel="noopener">Click here to learn how to get Amazon S3 credentials</a></li>
</ul>
<p>See the list of parameters below.</p>
<table style="border-collapse: collapse; width: 100%;" border="1">
<tbody>
<tr>
<th style="width: 6.30631%; text-align: center; vertical-align: middle;">Parameters</th>
<th style="width: 52.3582%; text-align: center; vertical-align: middle;">Value</th>
<th style="width: 41.2825%; text-align: center; vertical-align: middle;">Description</th>
</tr>
<tr>
<td style="width: 6.30631%; text-align: center; vertical-align: middle;">profile</td>
<td style="width: 52.3582%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'profile' => 'profile_name',</em></code></p>
<p>This parameter accepts only the name of the profile created.</p>
<p><a href="https://www.scriptcase.net/docs/en_us/v9/manual/07-tools/13-api/#id-06" target="_blank" rel="noopener">Click here</a>, to see how to create a profile.</p>
</td>
<td style="width: 41.2825%; text-align: left; vertical-align: top;">
<p>We must inform the name of the profile creating in the APIs option in the Tools menu.</p>
<p>When used, this parameter loads the settings informed when the profile is created.</p>
<p><strong>When used, the settings parameter does not need to be informed.</strong></p>
<p>For more details see <strong>Using the macro with profile</strong></p>
</td>
</tr>
<tr>
<td style="width: 6.30631%; text-align: center; vertical-align: middle;">settings</td>
<td style="width: 52.3582%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed. </p>
<p><code><em>'settings' => [<br /></em><em>'app_name' => 'scriptcase',<br /></em><em>'gateway' => 'dropbox',<br /></em><em>'api_key' => '',<br /></em><em>'api_secret' => '',<br /></em><em>'access_token' => '',<br /></em><em>],</em></code></p>
<p><strong>Note:</strong> For more information about the parameter, see the exclusive settings table below, for each of the APIs</p>
</td>
<td style="width: 41.2825%; text-align: left; vertical-align: top;">
<p>It receives an array with the access credentials for the API that will be used.</p>
<p><strong>When used, the profile parameter does not need to be entered.</strong></p>
</td>
</tr>
<tr>
<td style="width: 6.30631%; text-align: center; vertical-align: middle;">file</td>
<td style="width: 52.3582%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed. </p>
<p><code><em>'file' => {image_file_name},</em></code></p>
<p>Allowed options: </p>
<ul>
<li>{image_file_name}</li>
<li>[global_variable]</li>
<li>‘File path’</li>
</ul>
</td>
<td style="width: 41.2825%; text-align: left; vertical-align: top;">
<p>This parameter receives the full path until the file is located.</p>
<p>When using a field, it must be the upload nome do file type.</p>
</td>
</tr>
<tr>
<td style="width: 6.30631%; text-align: center; vertical-align: middle;"><span class="tlid-translation translation" lang="en"><span title="">destination</span></span></td>
<td style="width: 52.3582%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed. </p>
<p><strong>Using a field</strong><br /><code><em>'parents' => {field_name},</em></code></p>
<p><strong>Informando uma String</strong><br /><code><em>'parents' => ‘folder_name’,</em></code></p>
<p>Allowed options:</p>
<ul>
<li>{field_name}</li>
<li>[global_variable]</li>
<li>‘Folder name or local cloud storage path’</li>
</ul>
</td>
<td style="width: 41.2825%; text-align: left; vertical-align: top;">
<p>Directory where the file will be stored</p>
<p>When not informed, the file will be stored at the root of the storage server.</p>
</td>
</tr>
</tbody>
</table>
<h2>Using the macro with profile</h2>
<p>The use of the macro with a profile requires the prior creation of the same.</p>
<p><a href="https://www.scriptcase.net/docs/en_us/v9/manual/07-tools/13-api/#id-06" target="_blank" rel="noopener">Click here</a> to see how to create a profile on each of the available storage APIs.</p>
<p>The profile contains the data to use the desired API, thus, when using a profile in the macro, it is not necessary to use the settings parameter.</p>
<blockquote>
<p>The profile parameter accepts only the name of the profile created, for the dynamic use of the macro, it will be necessary to use the settings parameters.</p>
</blockquote>
<p><strong>Example of using the macro with the profile.</strong></p>
<pre><code>sc_api_download([<br />  'profile' => 'myApi',<br />  'file' => {file}, <br />  'destination' => {destination},<br />]);</code></pre>
<h2>Using the macro with settings parameter</h2>
<p>The array with the access credentials that must be passed in the settings parameter varies according to the API used.</p>
<p>See below how to use this parameter according to each of the available APIs.</p>
<blockquote>
<p>When using the settings parameter in the configuration in the macro, it is not necessary to inform a profile.</p>
</blockquote>
<h3>Using The Macro With Settings - Google Drive API</h3>
<p>First, we must have the credentials for using the Google Drive API in hand, <a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-google-drive-api-on-the-google-console" target="_blank" rel="noopener">click here</a> to learn how to obtain them.</p>
<p>After configuring the credentials, see below all the values of the array that must be passed in the settings parameter using the Google Drive API.</p>
<p><strong>All values below are mandatory when using the settings parameter</strong></p>
<table style="border-collapse: collapse; width: 100%;" border="1">
<tbody>
<tr style="height: 18px;">
<th style="width: 4.95134%; text-align: center; vertical-align: middle; height: 18px; background-color: #dddddd; border-color: #dddddd;">Index</th>
<th style="width: 19.1603%; text-align: center; vertical-align: middle; height: 18px; background-color: #dddddd; border-color: #dddddd;">Value</th>
<th style="width: 43.0325%; text-align: center; vertical-align: middle; height: 18px; background-color: #dddddd; border-color: #dddddd;">Description</th>
</tr>
<tr style="height: 129px;">
<td style="width: 4.95134%; height: 129px; text-align: center; vertical-align: middle;">app_name</td>
<td style="width: 19.1603%; height: 129px; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'app_name' => 'scriptcase',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 43.0325%; height: 129px; text-align: left; vertical-align: top;">
<p>App name entered when creating access credentials.</p>
<p> </p>
</td>
</tr>
<tr style="height: 129px;">
<td style="width: 4.95134%; height: 129px; text-align: center; vertical-align: middle;">gateway</td>
<td style="width: 19.1603%; height: 129px; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'gateway'  => 'google_driver',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 43.0325%; height: 129px; text-align: left; vertical-align: top;">
<p>Gateway name to identify the API used.</p>
<p> </p>
</td>
</tr>
<tr style="height: 197px;">
<td style="width: 4.95134%; height: 197px; text-align: center; vertical-align: middle;">json_oauth</td>
<td style="width: 19.1603%; height: 197px; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'json_oauth'  => 'JSON_code',</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 43.0325%; height: 197px; text-align: left; vertical-align: top;">
<p>Receives the contents of the user generated authentication (JSON) file.</p>
<p>This file must be downloaded after creating the credentials on the google website.</p>
</td>
</tr>
<tr style="height: 179px;">
<td style="width: 4.95134%; height: 179px; text-align: center; vertical-align: middle;">auth_code</td>
<td style="width: 19.1603%; height: 179px; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'auth_code'  => '5/4wHt7TBTY4MtvQ',</em></code></p>
<p>Allowed options:</p>
<ul>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 43.0325%; height: 179px; text-align: left; vertical-align: top;">
<p>Receives the auth_code code, generated after configuring the API following the steps described in the tutorial </p>
<p><a href="https://help.scriptcase.net/portal/en/kb/articles/how-to-generate-auth-code-and-token-code#Generate_auth_code_with_sc_api_gc_get_url_macro" target="_blank" rel="noopener">How to generate the auth_code for using the Google Driver API</a></p>
</td>
</tr>
<tr style="height: 197px;">
<td style="width: 4.95134%; height: 197px; text-align: center; vertical-align: middle;">token_code</td>
<td style="width: 19.1603%; height: 197px; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'token_code'  => '4/4wHt7TBTY4MtvQ',</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 43.0325%; height: 197px; text-align: left; vertical-align: top;"><span style="color: #4d4d4d; font-family: OpenSans, Raleway, Lato, Arial, sans-serif; font-size: 16px; background-color: #ffffff;">It is possible to generate the token_code using our </span><a style="box-sizing: inherit; background-color: #ffffff; color: #0070ff; text-decoration-line: none; touch-action: manipulation; z-index: 91; position: relative; display: inline-block; border-bottom: 1px solid transparent; font-family: OpenSans, Raleway, Lato, Arial, sans-serif; font-size: 16px;" href="https://help.scriptcase.net/portal/en/kb/articles/how-to-generate-auth-code-and-token-code#Generate_token_code_with_sc_api_gc_get_obj_macro" target="_blank" rel="noopener">sc_api_gc_get_obj macro</a></td>
</tr>
</tbody>
</table>
<p><strong><br />Examples when using the macro in Google Drive implementing the parameter settings </strong></p>
<pre><code>sc_api_download([</code><br /><code>  'settings' => [</code><br /><code>    'app_name' => {appname},</code><br /><code>    'gateway' => 'google_drive',</code><br /><code>    'json_oauth' => {jsonoauth},</code><br /><code>    'auth_code' => {authcode},</code><br /><code>    'token_code' => {tokencode},</code><br /><code>  ],</code><br /><code>'file' => {files},</code><br /><code>'destination' => {destination},<br />]);</code></pre>
<p> </p>
<h3>Using A Macro With Settings - Dropbox</h3>
<p>First, we must have the credentials for using the Google Drive API in hand, <a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-dropbox-api" target="_blank" rel="noopener">click here</a> to learn how to obtain them.</p>
<p>After configuring the credentials, see below all the values of the array that must be passed in the settings parameter using the Dropbox API.</p>
<p><strong>All values below are mandatory when using the settings parameter</strong></p>
<table style="border-collapse: collapse; width: 100%;" border="1">
<tbody>
<tr>
<th style="width: 4.50226%; text-align: center; vertical-align: middle;">Index</th>
<th style="width: 19.5431%; text-align: center; vertical-align: middle;">Value</th>
<th style="width: 23.1976%; text-align: center; vertical-align: middle;">Description</th>
</tr>
<tr>
<td style="width: 4.50226%; text-align: center; vertical-align: middle;">app_name</td>
<td style="width: 19.5431%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'app_name' => 'scriptcase',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 23.1976%; text-align: left; vertical-align: top;">
<p>App name entered when creating access credentials.</p>
</td>
</tr>
<tr>
<td style="width: 4.50226%; text-align: center; vertical-align: middle;">gateway</td>
<td style="width: 19.5431%; text-align: left; vertical-align: top;">
<p>Exemplo de como o parâmetro deve ser informado.</p>
<p><code><em>'gateway'  => 'google_driver',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 23.1976%; text-align: left; vertical-align: top;">
<p>Gateway name to identify the API used.</p>
</td>
</tr>
<tr>
<td style="width: 4.50226%; text-align: center; vertical-align: middle;">api_key</td>
<td style="width: 19.5431%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'api_key’  => {field_name},</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 23.1976%; text-align: left; vertical-align: top;">
<p>Receives the app key, generated after configuring the API.</p>
</td>
</tr>
<tr>
<td style="width: 4.50226%; text-align: center; vertical-align: middle;">api_secret</td>
<td style="width: 19.5431%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'api_secret’  => {field_name},</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 23.1976%; text-align: left; vertical-align: top;">
<p>Receives the app secret, generated after configuring the API.</p>
</td>
</tr>
</tbody>
</table>
<p><strong><br />Examples when using the macro in Dropbox implementing the parameter settings</strong> </p>
<pre><code>sc_api_download([<br />  'settings' => [</code><br /><code>    'gateway' => 'dropbox',</code><br /><code>    'api_key' => {apikey},</code><br /><code>    'api_secret' => {apisecret},</code><br /><code>    'access_token' => {accesstoken},</code><br /><code>  ],</code><br /><code>'file' => {file},</code><br /><code>'destination' => {destination},<br /></code><code>]);</code></pre>
<p> </p>
<h3>Using The Macro With Settings - Amazon S3</h3>
<p>First, we must have the credentials for using the Amazon S3 STORAGE API in hand, <a href="https://help.scriptcase.net/portal/en/kb/articles/enabling-amazon-s3-api" target="_blank" rel="noopener">click here</a> to learn how to obtain them.</p>
<p>After configuring the credentials, see below all the values of the array that must be passed in the settings parameter using the Amazon S3 API.</p>
<p><strong>All values below are mandatory when using the settings parameter]</strong></p>
<table style="border-collapse: collapse; width: 100%;" border="1">
<tbody>
<tr>
<th style="width: 3.2536%; text-align: center; vertical-align: middle;">Index</th>
<th style="width: 14.261%; text-align: center; vertical-align: middle;">Value</th>
<th style="width: 38.1994%; text-align: center; vertical-align: middle;">Description</th>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">app_name</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'app_name' => 'scriptcase',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>App name entered when creating access credentials.</p>
</td>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">gateway</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'gateway'  => 'google_driver',</em></code></p>
<p>This index accepts only string</p>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>Gateway name to identify the API used.</p>
</td>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">api_key</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'api_key’  => {nome_campo},</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>Receives the api key, generated after configuring the API.</p>
</td>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">api_secret</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'api_secret’  => {nome_campo},</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>Receives the api secret, generated after configuring the API.</p>
</td>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">region</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'region'  => 'us-east-1',</em></code></p>
<p>The region parameter of the macro accepts only the region code.</p>
<p>To make it easier, follow a link to check the code for each region.</p>
<p><a href="https://docs.aws.amazon.com/general/latest/gr/rande.html#regional-endpoints" target="_blank" rel="noopener">https://docs.aws.amazon.com/general/latest/gr/rande.html</a></p>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>Receives the region code, the same used in the creation of credentials.</p>
</td>
</tr>
<tr>
<td style="width: 3.2536%; text-align: center; vertical-align: middle;">bucket</td>
<td style="width: 14.261%; text-align: left; vertical-align: top;">
<p>Example of how the parameter should be informed.</p>
<p><code><em>'bucket'  => 'bucket_name',</em></code></p>
<p>Allowed options:</p>
<ul>
<li>‘string’</li>
<li>{field_name}</li>
<li>$variable</li>
</ul>
</td>
<td style="width: 38.1994%; text-align: left; vertical-align: top;">
<p>Receives the Bucket Name, generated after configuring the API.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples when using the macro in Amazon S3 implementing the parameter settings </strong></p>
<pre><code>sc_api_download([</code><br /><code>'settings' => [</code><br /><code>'app_name' => 'scriptcase',</code><br /><code>    'gateway' => 'S3',</code><br /><code>    'api_key' => {apikey},</code><br /><code>    'api_secret' => {apisecret},</code><br /><code>    'region' => {api_region},</code><br /><code>    'bucket' => {api_bucket},</code><br /><code>  ],</code><br /><code>'file' => {file},</code><br /><code>'destination' => {destination},<br />]);</code></pre>
						</td>
					</tr>
				</table>
				<div id="id_div_app_cross" style="display: none">
					<br>
					<p style="font-weight: bold; margin-left: 10px;">Macro Scope</p>
					<table cellpadding=0 cellspacing=0 class="macros_desc_scope_table">
						<tr>
											<td style='text-align: left; font-weight: bold'>
				Grid application
			</td>
			<td style='text-align: left; font-weight: bold'>
				Form application
			</td>

						</tr>
						<tr>
								
		<td width='120px' style='background-color: #f7f4f4'>onRecord
		</td>

		<td width='120px' style='background-color: #f7f4f4'>onLoadAll<br>onRecord
		</td>

						</tr>
					</table>
				</div>				
			</td></tr>
			</table>
			</body>
			
</HTML>